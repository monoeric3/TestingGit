some source code
and some more added from monomac